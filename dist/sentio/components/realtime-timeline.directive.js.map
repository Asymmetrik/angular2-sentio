{"version":3,"sources":["sentio/components/realtime-timeline.directive.ts"],"names":[],"mappings":";AAAA,qBAA4H,eAAe,CAAC,CAAA;AAE5I,IAAY,MAAM,WAAM,oBAAoB,CAAC,CAAA;AAE7C,mCAA6B,4BAA4B,CAAC,CAAA;AAC1D,4BAA4C,qBAAqB,CAAC,CAAA;AAMlE;IA2BC,mCAAY,EAAc;QAX1B,oBAAoB;QACV,eAAU,GAAG,IAAI,mBAAY,EAAsC,CAAC;QAE9E,qBAAqB;QACX,eAAU,GAAG,IAAI,mBAAY,EAAO,CAAC;QACrC,cAAS,GAAG,IAAI,mBAAY,EAAO,CAAC;QACpC,gBAAW,GAAG,IAAI,mBAAY,EAAO,CAAC;QAO/C,mBAAmB;QACnB,IAAI,CAAC,YAAY,GAAG,IAAI,iCAAY,CAAqC,EAAE,EAAE,MAAM,CAAC,KAAK,CAAC,gBAAgB,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAE/H,qBAAqB;QACrB,IAAI,CAAC,UAAU,GAAG,IAAI,wBAAU,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;IAE/E,CAAC;IAED;;OAEG;IACH,sDAAkB,GAAlB,UAAmB,GAAoB;QAEtC,IAAI,MAAM,GAAG,KAAK,CAAC;QAEnB,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;YAExE,8BAA8B;YAC9B,IAAI,CAAC,YAAY,CAAC,KAAK;iBACrB,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,MAAM,GAAG,IAAI,CAAC;QAEf,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;YAE3E,8BAA8B;YAC9B,IAAI,CAAC,YAAY,CAAC,KAAK;iBACrB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACrB,MAAM,GAAG,IAAI,CAAC;QAEf,CAAC;QAED,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACZ,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;QAClC,CAAC;IACF,CAAC;IAGD,4CAAQ,GAAR,UAAS,KAAU;QAClB,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC5C,CAAC;IAED,4CAAQ,GAAR;QAAA,iBAwBC;QAtBA,uBAAuB;QACvB,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAC;QAE/B,iCAAiC;QACjC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,aAAa,EAAE,UAAC,CAAM,IAAO,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAChG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,iBAAiB,EAAE,UAAC,CAAM,IAAO,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAC,CAAM,IAAO,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEjG,6BAA6B;QAC7B,IAAI,CAAC,UAAU,CAAC,YAAY;aAC1B,SAAS,CAAC;YAEV,0BAA0B;YAC1B,KAAI,CAAC,kBAAkB,CAAC,KAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC;YACnD,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;QAElC,CAAC,CAAC,CAAC;QAEJ,oCAAoC;QACpC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC;QACnD,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;IAElC,CAAC;IAED,+CAAW,GAAX;QACC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;IAC3B,CAAC;IAED,+CAAW,GAAX,UAAY,OAAwC;QAEnD,IAAI,MAAM,GAAY,KAAK,CAAC;QAC5B,IAAI,MAAM,GAAY,KAAK,CAAC;QAE5B,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACzC,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,aAAa,EAAE,CAAC;QACtD,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9C,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,aAAa,EAAE,CAAC;QACxD,CAAC;QAED,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9D,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,aAAa,EAAE,CAAC;QACxD,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAC9D,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,aAAa,EAAE,CAAC;QACxD,CAAC;QAED,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACvC,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC1C,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,aAAa,EAAE,CAAC;QACtD,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAChD,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,aAAa,EAAE,CAAC;QACzD,CAAC;QAED,gCAAgC;QAChC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACZ,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;QAClC,CAAC;QACD,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACZ,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;QAClC,CAAC;IACF,CAAC;IA7ID;QAAC,YAAK,EAAE;;4DAAA;IACR;QAAC,YAAK,EAAE;;8DAAA;IAER;QAAC,YAAK,EAAE;;8DAAA;IACR;QAAC,YAAK,EAAE;;8DAAA;IAER;QAAC,YAAK,EAAE;;4DAAA;IACR;QAAC,YAAK,EAAE;;0DAAA;IACR;QAAC,YAAK,EAAE;;+DAAA;IAER;QAAC,YAAK,EAAE;;kEAAA;IACR;QAAC,YAAK,EAAE;;mEAAA;IAGR;QAAC,aAAM,EAAE;;iEAAA;IAGT;QAAC,aAAM,EAAE;;iEAAA;IACT;QAAC,aAAM,EAAE;;gEAAA;IACT;QAAC,aAAM,EAAE;;kEAAA;IA6CT;QAAC,mBAAY,CAAC,eAAe,EAAE,CAAC,QAAQ,CAAC,CAAC;;;;6DAAA;IAtE3C;QAAC,gBAAS,CAAC;YACV,QAAQ,EAAE,wBAAwB;SAClC,CAAC;;iCAAA;IAmJF,gCAAC;AAAD,CAlJA,AAkJC,IAAA;AAlJY,iCAAyB,4BAkJrC,CAAA","file":"realtime-timeline.directive.js","sourcesContent":["import { Directive, ElementRef, EventEmitter, HostListener, Input, OnChanges, OnDestroy, OnInit, Output, SimpleChange} from '@angular/core';\n\nimport * as sentio from '@asymmetrik/sentio';\n\nimport { ChartWrapper } from '../util/chart-wrapper.util';\nimport { ResizeDimension, ResizeUtil } from '../util/resize.util';\n\n\n@Directive({\n\tselector: 'sentioRealtimeTimeline'\n})\nexport class RealtimeTimelineDirective\n\timplements OnChanges, OnDestroy, OnInit {\n\n\t@Input() model: any[];\n\t@Input() markers: any[];\n\n\t@Input() yExtent: [number, number];\n\t@Input() xExtent: [number, number];\n\n\t@Input() delay: number;\n\t@Input() fps: number;\n\t@Input() interval: number;\n\n\t@Input() resizeWidth: boolean;\n\t@Input() resizeHeight: boolean;\n\n\t// Chart Ready event\n\t@Output() chartReady = new EventEmitter<sentio.chart.RealtimeTimelineChart>();\n\n\t// Interaction events\n\t@Output() markerOver = new EventEmitter<any>();\n\t@Output() markerOut = new EventEmitter<any>();\n\t@Output() markerClick = new EventEmitter<any>();\n\n\tchartWrapper: ChartWrapper<sentio.chart.RealtimeTimelineChart>;\n\tresizeUtil: ResizeUtil;\n\n\tconstructor(el: ElementRef) {\n\n\t\t// Create the chart\n\t\tthis.chartWrapper = new ChartWrapper<sentio.chart.RealtimeTimelineChart>(el, sentio.chart.realtimeTimeline(), this.chartReady);\n\n\t\t// Set up the resizer\n\t\tthis.resizeUtil = new ResizeUtil(el, (this.resizeHeight || this.resizeWidth));\n\n\t}\n\n\t/**\n\t * For the timeline, both dimensions scale independently\n\t */\n\tsetChartDimensions(dim: ResizeDimension): void {\n\n\t\tlet resize = false;\n\n\t\tif (null != dim.width && this.chartWrapper.chart.width() !== dim.width) {\n\n\t\t\t// pin the height to the width\n\t\t\tthis.chartWrapper.chart\n\t\t\t\t.width(dim.width);\n\t\t\tresize = true;\n\n\t\t}\n\n\t\tif (null != dim.height && this.chartWrapper.chart.height() !== dim.height) {\n\n\t\t\t// pin the height to the width\n\t\t\tthis.chartWrapper.chart\n\t\t\t\t.height(dim.height);\n\t\t\tresize = true;\n\n\t\t}\n\n\t\tif (resize) {\n\t\t\tthis.chartWrapper.chart.resize();\n\t\t}\n\t}\n\n\t@HostListener('window:resize', ['$event'])\n\tonResize(event: any) {\n\t\tthis.resizeUtil.resizeObserver.next(event);\n\t}\n\n\tngOnInit() {\n\n\t\t// Initialize the chart\n\t\tthis.chartWrapper.initialize();\n\n\t\t// register for the marker events\n\t\tthis.chartWrapper.chart.dispatch().on('markerClick', (p: any) => { this.markerClick.emit(p); });\n\t\tthis.chartWrapper.chart.dispatch().on('markerMouseover', (p: any) => { this.markerOver.emit(p); });\n\t\tthis.chartWrapper.chart.dispatch().on('markerMouseout', (p: any) => { this.markerOut.emit(p); });\n\n\t\t// Set up the resize callback\n\t\tthis.resizeUtil.resizeSource\n\t\t\t.subscribe(() => {\n\n\t\t\t\t// Do the resize operation\n\t\t\t\tthis.setChartDimensions(this.resizeUtil.getSize());\n\t\t\t\tthis.chartWrapper.chart.redraw();\n\n\t\t\t});\n\n\t\t// Set the initial size of the chart\n\t\tthis.setChartDimensions(this.resizeUtil.getSize());\n\t\tthis.chartWrapper.chart.redraw();\n\n\t}\n\n\tngOnDestroy() {\n\t\tthis.resizeUtil.destroy();\n\t}\n\n\tngOnChanges(changes: { [key: string]: SimpleChange }) {\n\n\t\tlet resize: boolean = false;\n\t\tlet redraw: boolean = false;\n\n\t\tif (changes['model']) {\n\t\t\tthis.chartWrapper.chart.data(this.model);\n\t\t\tredraw = redraw || !changes['model'].isFirstChange();\n\t\t}\n\t\tif (changes['markers']) {\n\t\t\tthis.chartWrapper.chart.markers(this.markers);\n\t\t\tredraw = redraw || !changes['markers'].isFirstChange();\n\t\t}\n\n\t\tif (changes['yExtent']) {\n\t\t\tthis.chartWrapper.chart.yExtent().overrideValue(this.yExtent);\n\t\t\tredraw = redraw || !changes['yExtent'].isFirstChange();\n\t\t}\n\t\tif (changes['xExtent']) {\n\t\t\tthis.chartWrapper.chart.xExtent().overrideValue(this.xExtent);\n\t\t\tredraw = redraw || !changes['xExtent'].isFirstChange();\n\t\t}\n\n\t\tif (changes['fps']) {\n\t\t\tthis.chartWrapper.chart.fps(this.fps);\n\t\t}\n\t\tif (changes['delay']) {\n\t\t\tthis.chartWrapper.chart.delay(this.delay);\n\t\t\tredraw = redraw || !changes['delay'].isFirstChange();\n\t\t}\n\t\tif (changes['interval']) {\n\t\t\tthis.chartWrapper.chart.interval(this.interval);\n\t\t\tredraw = redraw || !changes['interval'].isFirstChange();\n\t\t}\n\n\t\t// Only redraw once if necessary\n\t\tif (resize) {\n\t\t\tthis.chartWrapper.chart.resize();\n\t\t}\n\t\tif (redraw) {\n\t\t\tthis.chartWrapper.chart.redraw();\n\t\t}\n\t}\n\n}\n"]}